/*! experimentalSHMUP 27-01-2014 */
function logPlay(){_gaq.push(["_trackEvent","Button","Play"])}function start(){var a=new Date;window.app=new SL.Game({canvas:document.getElementById("GameCanvas")}),app.camera=new SL.Camera(app.sctx,new SL.Vec2(400,300)),app.assetCollection=new SL.AssetCollection("res/assets.json",app,function(){_gaq.push(["_trackEvent","Game","Load","",(new Date-a)/1e3]),$(".canvas-container").append(domjs.build(templates.modal));var b=new SL.Scene("loading",[],function(){});b.addEntity({percentLoaded:0,textLocation:new SL.Vec2(400,300),update:function(){100===app.assetCollection.getLoadedPercentage()&&app.transitionScene("menu")},draw:function(a){a.clearRect(0,0,800,600),app.camera.drawText({location:app.screenSize.getScaled(.5),align:"center",text:app.assetCollection.getLoadedPercentage().toFixed()+"%",color:TEXT_COLOR,font:"72px Arial"})}});var c=new SL.Scene("menu",[],function(){var a=$(".modal");a.append(domjs.build(templates.menu)),$(".menu .button").on("click",function(){a.empty(),a.off(),app.transitionScene($(this).attr("id"))})}),d=new SL.Scene("settings",[],function(){var a=$(".modal");a.append(domjs.build(templates.settings)),$(".menu .button").on("click",function(){var b=$(this).attr("id");"menu"===b&&(a.empty(),a.off(),app.transitionScene(b))}),app.currentScene.addEntity({update:function(){},draw:function(a){a.clearRect(0,0,800,600)}})}),e=new SL.Scene("about",[],function(){var a=$(".modal");a.append(domjs.build(templates.about)),$(".menu .button").on("click",function(){a.empty(),a.off(),app.transitionScene($(this).attr("id"))}),app.currentScene.addEntity({update:function(){},draw:function(a){a.clearRect(0,0,800,600)}})}),f=new SL.Scene("game",[],function(){test()});app.addScene(b),app.addScene(c),app.addScene(f),app.addScene(d),app.addScene(e),app.transitionScene("loading"),app.start()})}function Ship(a){var b=this,c=app.assetCollection.assets.blueprints[a.blueprint];c.ship=b,b.blueprint=new Blueprint(c),b.messageQueue=[],b.collider=new SL.Circle(a.location,b.blueprint.size),b.rotation=0,b.weight=b.blueprint.weight,b.update=function(){b.blueprint.update();for(var a=0;a<b.blueprint.slots.length;a++)b.blueprint.slots[a].module&&b.blueprint.slots[a].module.update()},b.draw=function(){app.camera.drawCircle({origin:b.collider.origin,radius:b.collider.radius,lineColor:"red",lineWidth:2}),b.blueprint.draw();for(var a=0;a<b.blueprint.slots.length;a++)b.blueprint.slots[a].module&&b.blueprint.slots[a].module.draw()},b.setSlotModule=function(a,c){a.isModuleCompatible(c)&&(a.module?b.weight-a.module.weight+c.weight<=b.blueprint.maxWeight&&(b.weight=b.weight-a.module.weight+c.weight,a.module=c,a.module.ship=b,a.module.slot=a):b.weight+c.weight<=b.blueprint.maxWeight&&(b.weight=b.weight+c.weight,a.module=c,a.module.ship=b,a.module.slot=a))}}function Blueprint(a){var b=this;for(var c in a)b[c]=a[c];for(c=0;c<b.slots.length;c++){var d=b.slots[c];d.blueprint=b,b.slots[c]=new Slot(d)}b.image=app.assetCollection.getImage(b.name+"-hull.png"),b.update=function(){},b.draw=function(){app.camera.drawImage({image:b.image,location:b.ship.collider.origin})}}function Slot(a){var b=this;for(var c in a)b[c]=a[c];b.location=new SL.Vec2(b.location.x,b.location.y),b.module=null,b.isModuleCompatible=function(a){return"DYNAMIC"===b.type||b.type===a.type}}function Module(a){var b=this,c=function(){b.BLASTER=function(){b.update=function(){},b.draw=function(){app.camera.drawText({location:b.ship.collider.origin.getTranslated(b.slot.location),align:"center",text:"B"})}},b.ENGINE=function(){b.update=function(){},b.draw=function(){app.camera.drawText({location:b.ship.collider.origin.getTranslated(b.slot.location),align:"center",text:"E"})}},b.UTILITY=function(){b.update=function(){},b.draw=function(){}},b.ATTITUDE=function(){b.update=function(){},b.draw=function(){app.camera.drawText({location:b.ship.collider.origin.getTranslated(b.slot.location),align:"center",text:"A"})}},b[b.type]()};for(var d in a)b[d]=a[d];c(b)}function test(){var a=new Ship({blueprint:"fighter",location:new SL.Vec2(0,0)});a.setSlotModule(a.blueprint.slots[0],new Module(app.assetCollection.assets.modules.BLASTER.fighter)),a.setSlotModule(a.blueprint.slots[1],new Module(app.assetCollection.assets.modules.ENGINE.fighter)),a.setSlotModule(a.blueprint.slots[2],new Module(app.assetCollection.assets.modules.ATTITUDE.fighter)),a.setSlotModule(a.blueprint.slots[3],new Module(app.assetCollection.assets.modules.ATTITUDE.fighter)),app.currentScene.addEntity(a)}SL=sugarLab;var CAMERA_OFFSET=new SL.Vec2(0,0);